library(tximport)
library(readr)
myfiles = c("abundance.tsv")
tx2gene = read.table("transcript.gene.map",header=TRUE)
txi.kallisto.counts<-tximport(myfiles,type="kallisto",txIn = TRUE,tx2gene = tx2gene)
txi.tpm.dataframe<-as.data.frame(txi.kallisto.counts$abundance)
txi.tpm.dataframe$geneid<-row.names(txi.tpm.dataframe)
colnames(txi.tpm.dataframe)<-c("tpm","geneid")
write.table(txi.tpm.dataframe,"mygenelevelTPMs.tsv",row.names=FALSE,quote=FALSE)
